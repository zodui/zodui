var $e=Object.defineProperty;var De=(n,t,e)=>t in n?$e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var F=(n,t,e)=>(De(n,typeof t!="symbol"?t+"":t,e),e),je=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)};var H=(n,t,e)=>(je(n,t,"read from private field"),e?e.call(n):t.get(n)),de=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)};import{j as ae,r as u}from"./react-64d51446.js";import*as j from"zod";import{ZodFirstPartyTypeKind as ge,ZodUnion as Ee,ZodError as ye}from"zod";import{B as Me,I as xe,a as Ae,b as Pe,S as Ve,c as Ue,R as fe,D as Le,d as Fe,T as Ke,e as ze,f as Be,g as He,h as qe,i as Ge,j as We,k as Je}from"./tdesign-react-90877bd8.js";import{A as Qe,M as Xe,L as Ye,C as et,D as tt,R as me,a as nt,b as rt}from"./tdesign-icons-react-1b74273e.js";const O=ae.Fragment,c=ae.jsx,S=ae.jsxs,ot="modulepreload",st=function(n){return"/zodui/"+n},he={},re=function(t,e,r){if(!e||e.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(e.map(s=>{if(s=st(s),s in he)return;he[s]=!0;const i=s.endsWith(".css"),a=i?'[rel="stylesheet"]':"";if(!!r)for(let p=o.length-1;p>=0;p--){const b=o[p];if(b.href===s&&(!i||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const m=document.createElement("link");if(m.rel=i?"stylesheet":ot,i||(m.as="script",m.crossOrigin=""),m.href=s,document.head.appendChild(m),i)return new Promise((p,b)=>{m.addEventListener("load",p),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s})};var it=(n=>{})();const d={...it,...ge},ct=[],at=[d.ZodTuple,d.ZodObject],ut=[d.ZodRecord,d.ZodMap],lt=[d.ZodString,d.ZodNumber,d.ZodBoolean,d.ZodDate],dt=lt,ft=[d.ZodUnion,d.ZodDiscriminatedUnion],mt=ft,ht=[d.ZodArray,d.ZodTuple,d.ZodSet,d.ZodMap,d.ZodRecord,d.ZodObject],pe=ht;function be(n,t){const e=t??n,r=t?`framework.${t.key}.units`:"units";let o=function(s,i,a){return i.map(m=>`${r}.${s}.${m}`).forEach(m=>{n.upd(m,(p=[])=>p.concat(a),p=>p.filter(b=>!a.includes(b)))}),this};return o=o.bind(e),o.composer=function(){return this},o.composer=o.composer.bind(e),o.switcher=function(){return this},o.switcher=o.switcher.bind(e),o}class gt{constructor(t,e){F(this,"defineUnit");F(this,"defineRndr",this.defineRender);this.key=t,this.ctx=e,this.defineUnit=be(e,this)}defineComp(t,e){return this.ctx.set(`framework.${this.key}.components.${t}`,e),this}defineIcon(t,e){return this.ctx.set(`framework.${this.key}.icons.${t}`,e),this}defineRender(t,e){return this.ctx.set(`framework.${this.key}.rndrs.${t}`,e),this}}function ne(n,t){return{name:n,call:t}}const K=Symbol("effect");var V;class yt{constructor(){de(this,V,new Map)}on(t,e){const r=H(this,V).get(t)||[],o=r.length;return r.push(e),H(this,V).set(t,r),()=>{r.splice(o,1),H(this,V).set(t,r)}}do(...t){const[e,...r]=t;(H(this,V).get(e)||[]).forEach(s=>s(...r))}}V=new WeakMap;var Jt;const W=class W{constructor(t=new Map,e=new yt){F(this,Jt,[]);F(this,"defineUnit");this.store=t,this.emitter=e,this.defineUnit=be(this)}extend(){return new W(this.store,this.emitter)}set(t,e){var r;return(r=this.store)==null||r.set(t,e),this.emitter.do(t,e),this[K].push(()=>{var s,i;((s=this.store)==null?void 0:s.get(t))===e&&((i=this.store)==null||i.delete(t))}),this}upd(t,e,r){var s,i;const o=e((s=this.store)==null?void 0:s.get(t));return(i=this.store)==null||i.set(t,o),this.emitter.do(t,o),this[K].push(()=>{var a,l;(l=this.store)==null||l.set(t,r((a=this.store)==null?void 0:a.get(t)))}),this}del(t){var r,o;const e=(r=this.store)==null?void 0:r.get(t);return(o=this.store)==null||o.delete(t),this.emitter.do(t),this[K].push(()=>{var s;(s=this.store)==null||s.set(t,e)}),this}get(t){var e;return[(e=this.store)==null?void 0:e.get(t),this.emitter.on.bind(this.emitter,t)]}use(t){let e;const r=this.extend();function o(i){i.call(r),e=()=>{r[K].forEach(a=>a())}}if(typeof t=="function"){const i=t();if(i instanceof Promise){let a=!1;i.then(l=>{a||(l.default&&(l=l.default),o(l))}),e=()=>{a=!0}}else throw new Error("plugin must be a function or a promise")}else o(t);const s=()=>e();return this[K].push(s),s}framework(t){return new gt(t,this)}};Jt=K,F(W,"global",new W);let se=W;function ve(n){var t;return((t=n==null?void 0:n.split(" "))==null?void 0:t.filter(e=>e!==" "&&e!==""))??[]}const v=(n,t)=>{var e;return((e=(n==null?void 0:n._def)||n)==null?void 0:e.typeName)===t};function ee(n,t){var e;return t.includes((e=n==null?void 0:n._def)==null?void 0:e.typeName)}function G(n){var t;if(v(n,ge.ZodDefault))return(t=n==null?void 0:n._def)==null?void 0:t.defaultValue()}function Ce(n){return n.replace(/\[([^\]]+)]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>').replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/~~([^~]+)~~/g,"<del>$1</del>").replace(/\n/g,"<br />").replace(/\|\|([^|]+)\|\|/g,'<span class="spoiler">$1</span>')}function ie(n,t){const e=Object.keys(n),r=Object.keys(t);for(const o of e){const s=n[o];if(Object.hasOwn(t,o)){const i=t[o];if(Array.isArray(s)&&Array.isArray(i)){[...s,...i];break}if(typeof s=="object"&&typeof i=="object"){ie(s,i);break}}n[o]}for(const o of r)Object.hasOwn(n,o)||t[o];return{...n,...t}}function U(...n){return n.filter(t=>!!t).map(t=>typeof t=="string"?t:Object.keys(t).filter(e=>t[e]).join(" ")).join(" ")}const _e=n=>n.options.flatMap(t=>t instanceof Ee?_e(t):t);function we(n){try{!Object.hasOwn(j.ZodType.prototype,`_${n}`)&&Object.defineProperty(j.ZodType.prototype,`_${n}`,{get(){return this._def[n]}}),!Object.hasOwn(j.ZodType.prototype,n)&&Object.defineProperty(j.ZodType.prototype,n,{get(){return t=>{const e=this.constructor;return new e({...this._def,[n]:t})}}})}catch(t){console.error(t)}}we("mode");we("label");!Object.hasOwn(j.ZodType.prototype,"type")&&Object.defineProperty(j.ZodType.prototype,"type",{get(){var n;return((n=this._def)==null?void 0:n.typeName.replace("Zod","").toLowerCase())??"unknown"}});const Te={...j};function pt(n){return j.object(new n)}Te.clazz=pt;function bt(n){return j.object(n)}Te.asObject=bt;const Ie=u.createContext(null);function vt(){const[n,t]=u.useState("");return{className:n,ControllerClassName:u.useCallback(({children:e})=>c(Ie.Provider,{value:{setClassName:t},children:e}),[])}}const nn=()=>u.useContext(Ie),Ct=u.createContext(null),J=n=>{const t=u.useContext(Ct)??se.global,[e,r]=t.get(n),[o,s]=u.useState(()=>e);return u.useEffect(()=>{s(()=>e)},[e]),u.useEffect(()=>r(i=>s(()=>i)),[r]),o},L=n=>J(`framework.react.components.${n}`),_t=n=>J(`framework.react.icons.${n}`),Re=u.createContext(null);function wt({error:n,setE:t}){return u.useEffect(()=>{t(n)},[n,t]),c(O,{})}function Tt(){const[n,t]=u.useState(),e=u.useMemo(()=>({reset:()=>t(void 0),error:n,throwError(r){return typeof r=="string"&&(r=new Error(r)),r.message===(n==null?void 0:n.message)?null:c(wt,{error:r,setE:t})},ThrowError({error:r}){return this.throwError(r)}}),[n]);return{reset:()=>t(void 0),error:n,ErrorHandler:u.useCallback(({children:r})=>c(Re.Provider,{value:e,children:r}),[e])}}const Ze=()=>u.useContext(Re),ce=u.createContext(null);function rn(n={}){const t=u.useContext(ce),[e,r]=u.useState(n),o=u.useMemo(()=>({...Se,...t,...e}),[t,e]);return{configure:o,setConfigure:r,ItemConfigurer:({children:s})=>c(ce.Provider,{value:o,children:s})}}const Se={verifyDebounceTime:300,actualTimeVerify:!0},Oe=()=>u.useContext(ce)??Se,ke=u.createContext(null);function It(){const n=u.useRef(),t=u.useCallback(o=>(n.current=o,()=>{n.current=void 0}),[]),e=u.useRef(),r=u.useCallback(o=>{var s;e.current=o,(s=n.current)==null||s.call(n,o)},[]);return{Append:()=>{const[o,s]=u.useState(e.current);return u.useEffect(()=>t(s),[]),c(O,{children:o})},ItemSerter:u.useCallback(({children:o})=>c(ke.Provider,{value:{Append:({children:s,deps:i=[]})=>(u.useEffect(()=>r(s),[...i]),null)},children:o}),[r])}}const Rt=()=>u.useContext(ke),Ne=n=>{const t=_t(n.name);return t?c(t,{...n}):c(O,{})},E=({icon:n,...t})=>{t=Object.assign({shape:"square",variant:"outline"},t);const e=u.useMemo(()=>typeof n=="string"?c(Ne,{name:n}):n,[n]),r=L("Button");return r?c(r,{icon:e,...t}):c("button",{...t,children:t.children?t.children:e})},Zt=n=>{const t=L("Dropdown");return t?c(t,{...n}):c(O,{})},Y=n=>{const t=L("Input");if(t)return c(t,{...n});const{onChange:e,value:r,defaultValue:o,...s}=n;return c("input",{value:r??o??"",onChange:i=>{const a=i.target.value;if(n.type==="number"){e==null||e(Number(a));return}e==null||e(a)},...s})},on=n=>{const t=L("InputAdornment");if(t)return c(t,{...n});const{prev:e,next:r,children:o,className:s,style:i}=n;return S("span",{className:"zodui-input-adornment"+(s?" "+s:""),style:i,children:[e,o,r]})},sn=n=>{const t=L("RadioGroup");return t?c(t,{...n}):c(O,{children:"Not support Radio Group"})},St=n=>{const t=L("Select");if(t)return c(t,{...n});n=Object.assign({},n);const{onChange:e,...r}=n;return c("select",{...r,onChange:o=>e(o.target.options.selectedIndex),children:n.options.map(o=>c("option",{value:o.value,title:o.title,children:o.label},o.value))})},Ot=n=>{const{value:t,defaultValue:e,onChange:r,...o}=n,[s,i]=u.useState(t??e);u.useEffect(()=>{i(t??e)},[t,e]);const a=u.useCallback(l=>{i(l),r==null||r(l)},[r]);return c("input",{...o,type:"checkbox",checked:s,onChange:l=>a(l.target.checked)})},kt=n=>{const t=L("Switch");return t?c(t,{...n}):c(Ot,{...n})};function oe({target:n,...t}){const e=Ze(),r=J(`framework.react.rndrs.${n.replace(".",":")}`),o=u.useMemo(()=>{if(!r)return new Error(`Controller ${n} not found`);if(typeof r!="function")return new Error(`Controller ${n} is not a function`)},[r,n]);return u.useEffect(()=>{o===void 0&&e&&e.error!==void 0&&e.reset()},[o,e]),o?e==null?void 0:e.throwError(o):c(r,{...t})}const Nt=()=>{const n=u.useRef();return u.useCallback(t=>{typeof n.current=="number"&&clearTimeout(n.current),n.current=t},[])};function $t(n){return u.useMemo(()=>G(n),[n._def])}function Dt(n){return u.useMemo(()=>ve(n._mode),[n._mode])}function ue(n,t,e=[],r){const o=`${n}.${t}`,s=J(`units.${o}`),i=J(`framework.react.units.${o}`),[,a]=u.useMemo(()=>(s==null?void 0:s.find(([p])=>p(e,r)))??[],[s,e,r]),[,l]=u.useMemo(()=>(i==null?void 0:i.find(([p])=>p(e,r)))??[],[i,e,r]);return u.useMemo(()=>{if(a){let p;const b=(y,h)=>typeof y=="function"?y(h):{...y,...h};switch(typeof a){case"string":p=y=>c(oe,{target:a,...y});break;case"object":if(Array.isArray(a)){const[y,h]=a;p=T=>c(oe,{target:y,...b(h,T)})}break;case"function":{const[y,h]=a({modes:e,modelType:t,...r});p=T=>c(oe,{target:y,...b(h,T)});break}}return p}},[e,r,a,t])??l}function le(n,t,e){const r=u.useCallback(a=>{s(a),e==null||e(a)},[e]),[o,s]=u.useState(n??t),i=u.useRef(!1);return u.useEffect(()=>{i.current?s(n):(i.current=!0,r(n??t))},[r,t,n]),[o,r]}function jt(n){return n.map((t,e)=>({label:t._def.label??t._def.description??JSON.stringify(t._def.value)??`${e}nd`,title:t._def.description,value:e}))}function Et({uKey:n,modes:t,model:e,value:r,defaultValue:o,...s}){const[i,a]=le(r,o,s.onChange),[l,m]=u.useState(void 0),p=u.useMemo(()=>{if(v(e,d.ZodUnion))return _e(e);if(v(e,d.ZodDiscriminatedUnion))return e.options;throw new Error("model is not union or discriminated union")},[e]),b=u.useCallback(I=>{m(I);const g=p[I];v(g,d.ZodLiteral)&&(a==null||a(g._def.value))},[p,a]),y=u.useMemo(()=>v(e,d.ZodDiscriminatedUnion)?[e.discriminator]:[],[e]),h=u.useMemo(()=>y.map(I=>i==null?void 0:i[I]),[y,i]),T=u.useMemo(()=>{const I=new Map;return p.forEach(g=>{v(g,d.ZodObject)&&y.forEach(f=>{g.shape[f]&&(I.has(f)||I.set(f,[]),I.get(f).push(g.shape[f]))})}),I},[y,p]),N=u.useMemo(()=>jt(p),[p]),Z=u.useMemo(()=>{if(v(e,d.ZodDiscriminatedUnion)){const g=e.discriminator,f=T.get(g),C=y.findIndex($=>$===g);if(!f)return;const _=f.reduce(($,x)=>$.or(x));let w=0;for(let $=0;$<f.length;$++)if(f[$]._def.value===h[C]){w=$;break}const R=p[w];return v(R,d.ZodObject)?R.setKey(g,_.label(_.options[w]._def.label)):void 0}const I=p[l];if(l!==void 0){if(l<0||l>=p.length){m(void 0);return}return I}},[y,T,h,l,e,p]);u.useEffect(()=>{const I=i;let g=-1;v(e,d.ZodUnion)&&(g=p.findIndex(f=>v(f,d.ZodLiteral)&&f._def.value===I)),v(e,d.ZodDiscriminatedUnion),g!==-1&&m(g)},[i,p,e]);const M=Rt(),D=Z&&S(O,{children:[c(M.Append,{deps:[t,p,Z,a],children:t.includes("append")&&Z._def.typeName!==d.ZodLiteral&&c(Q,{model:Z,onChange:a})}),!t.includes("append")&&Z._def.typeName!==d.ZodLiteral&&c(O,{children:c(P,{model:Z,onChange:a})})]}),k=ue("complex",e._def.typeName,t,{model:e});return k?c(k,{modes:t,model:e,options:N,OptionRender:D,...s,value:i,defaultValue:o,onChange:a}):S(O,{children:[v(e,d.ZodUnion)&&S(O,{children:[c(St,{options:N,value:l,onChange:b}),D]}),v(e,d.ZodDiscriminatedUnion)&&c(O,{children:D})]})}function Mt({uKey:n,modes:t,model:e,...r}){const[o,s]=le(r.value,r.defaultValue,r.onChange),i={...r,value:o,onChange:s};let a=null;switch(e._def.typeName){case"ZodNumber":a=c(Y,{type:"number",...i});break;case"ZodString":a=c(Y,{...i});break;case"ZodDate":a=c(Y,{...i});break;case"ZodBoolean":a=c(kt,{...i});break}const l=ue("monad",e._def.typeName,t);return l?c(l,{modes:t,model:e,...i}):a}const q="multiple";function xt({uKey:n,modes:t,model:e,onChange:r,...o}){const s=e._def,i=u.useMemo(()=>{if(v(e,d.ZodObject)){const g=e.shape;return Object.entries(g).reduce((f,[C,_])=>{let w=_;return _._def.label===void 0&&(w=_.label(C)),_._def.description===void 0&&(w=_.describe(C)),f[C]=w,f},{})}return v(e,d.ZodRecord)?Object.entries(o.value??o.defaultValue??{}).reduce((g,[f])=>(g[f]=e.valueSchema,g),{}):{}},[e,o.defaultValue,o.value]),a=u.useCallback(g=>v(e,d.ZodArray)?e._def.type:v(e,d.ZodTuple)?e._def.items[g]:v(e,d.ZodSet)||v(e,d.ZodRecord)||v(e,d.ZodMap)?e._def.valueType:v(e,d.ZodObject)?Object.values(i)[g]:null,[i,s.items,s.valueType,s.typeName]),l=u.useMemo(()=>ee(e,[d.ZodArray,d.ZodSet])?1/0:v(e,d.ZodTuple)?e._def.items.length:v(e,d.ZodObject)?Object.entries(e._def.shape()??{}).length:v(e,d.ZodRecord)?Object.entries(o.value??o.defaultValue??{}).length:0,[s]),m=u.useMemo(()=>v(e,d.ZodTuple)?e._def.items:v(e,d.ZodObject)?Object.values(i):v(e,d.ZodSet)||v(e,d.ZodRecord)||v(e,d.ZodMap)?Array.from({length:l}).map((g,f)=>a(f)):[],[i,s.typeName,s.items,s.valueType]),[p,b]=u.useState(!1),y=u.useCallback(()=>{const g=o.value??o.defaultValue;return Object.keys(i).length>0?Object.entries(i).map(([f,C])=>(g instanceof Map?g.get(f):!Array.isArray(g)&&!(g instanceof Set)?g==null?void 0:g[f]:void 0)??G(C)):v(e,d.ZodTuple)?e._def.items.map(G):g instanceof Set?Array.from(g):Array.isArray(g)?g:[]},[i,e,o.defaultValue,o.value]),h=u.useRef(y());u.useEffect(()=>{h.current=y().map((g,f)=>g??h.current[f]),b(g=>!g)},[m,y]);const T=u.useMemo(()=>Object.keys(i??{}),[i]),N=u.useRef([]),Z=u.useCallback(g=>{const f=N.current;g!==void 0&&(h.current=g);let C;ee(e,[d.ZodArray,d.ZodTuple,d.ZodSet])?C=h.current:C=h.current.reduce((_,w,R)=>({..._,[f[R]??T[R]??R]:w}),{}),v(e,d.ZodMap)&&(C=new Map(Object.entries(C))),r==null||r(C)},[e,r,T]),M=u.useCallback((g="append")=>{const f=h.current,C=[G(a())];f===void 0?h.current=C:h.current=g==="append"?f.concat(C):C.concat(f),b(_=>!_),Z()},[Z,a]),D=u.useMemo(()=>at.includes(e._def.typeName),[e._def.typeName]),k=Ze(),I=ue("multiple",e._def.typeName,t,{schemas:m});return m.length===0&&e._def.typeName===d.ZodTuple?k==null?void 0:k.throwError(new Error("Tuple 类型必须包含一个元素")):I?c(I,{...o,modes:t,model:e,schemas:m,value:h.current,onChange:Z}):S(O,{children:[h.current.length===0&&c(E,{className:`${q}-create`,icon:"Add",onClick:()=>M()}),h.current.map((g,f)=>{const C=a(f);if(!C)return c(u.Fragment,{},f);const _=ut.includes(e._def.typeName);return S("div",{className:`${q}-item`,children:[((T[f]??(C==null?void 0:C._def.label))||_)&&c("div",{className:`${q}-item__label`+(_?" editable":""),children:_?c(Y,{className:"key-input",placeholder:"请输入键名",value:N.current[f],onChange:w=>{const $=N.current.slice();$[f]=w.toString(),N.current=$,b(x=>!x),Z()}}):C._def.label??T[f]}),c("div",{className:`${q}-item__index-tag`,children:f+1}),!D&&S(O,{children:[f===0?c(E,{shape:"square",variant:"outline",icon:"Prepend",onClick:()=>M("prepend")}):c(E,{shape:"square",variant:"outline",icon:"ArrowUp",onClick:()=>{const w=h.current[f];h.current[f]=h.current[f-1],h.current[f-1]=w,b(R=>!R),Z()}}),f===h.current.length-1?c(E,{shape:"square",variant:"outline",icon:"Append",onClick:()=>M("append")}):c(E,{shape:"square",variant:"outline",icon:"ArrowDown",onClick:()=>{const w=h.current[f];h.current[f]=h.current[f+1],h.current[f+1]=w,b(R=>!R),Z()}})]}),c(P,{disabled:o.disabled??!1,className:`${q}-item__container`,model:C,value:g,defaultValue:G(C),onChange:w=>{h.current[f]=w,Z()}}),c(E,{theme:"error",disabled:D?o.disabled??g===void 0:o.disabled,icon:D?"Clear":"Delete",onClick:()=>{D?h.current[f]=void 0:h.current=h.current.filter((w,R)=>R!==f),b(w=>!w),Z()}}),c(E,{icon:"More"})]},f)})]})}const At=[["monad",dt,Mt],["complex",mt,Et],["multiple",pe,xt]];function Pt(n,t){return ee(t[0],n)}function P(n){const{model:t,...e}=n,{className:r,ControllerClassName:o}=vt(),s=$t(t),i=n.defaultValue??s,a=Dt(t),[l,m=null]=u.useMemo(()=>{for(const[b,y,h]of At){const T=[t,h];if(Pt(y,T)){const[N,Z]=T;return[b,c(Z,{model:N,modes:a,...e})]}}return[]},[t,a,e]);if(v(t,d.ZodDefault)){const{innerType:b,defaultValue:y,typeName:h,...T}=t._def;return Object.assign(b._def,T),c(P,{...n,model:b,defaultValue:i})}if(v(t,d.ZodOptional)){const{innerType:b,typeName:y,...h}=t._def;return Object.assign(b._def,h),c(P,{...n,model:b})}if(v(t,d.ZodIntersection))return S(O,{children:[c(P,{...n,model:t._def.left}),c(P,{...n,model:t._def.right})]});const p=[Vt(d.ZodLiteral,({model:b})=>c(O,{children:JSON.stringify(b.value)}))];return c("div",{className:U("zodui-switcher",!!m&&l,t.type,r),children:c(o,{children:m||(p.reduce((b,[y,h])=>v(t,y)?c(h,{model:t}):b,null)??S("span",{style:{width:"100%"},children:["暂未支持的的类型 ",c("code",{children:t.type})]}))})})}function Vt(n,t){return[n,t]}const B="zodui-item";function Ut(n,t){const e=Oe(),{meta:{label:r,description:o},value:s,defaultValue:i,onChange:a,model:l,className:m}=n,p=u.useMemo(()=>ct.some(_=>{const w=ve(l._mode);return typeof _=="string"?w.some(R=>R==null?void 0:R.startsWith(_)):w.some(R=>_.test(R))}),[l._mode]),{Append:b,ItemSerter:y}=It(),{error:h,ErrorHandler:T}=Tt(),[N,Z]=u.useState(!1),[M,D]=u.useState(!1),k=u.useRef(s??i);k.current!==s&&!M&&(k.current=s);const I=u.useRef(),g=u.useCallback(_=>(I.current=_,()=>{I.current=void 0}),[]),f=Nt(),C=u.useCallback((_,w=!1,R=e.actualTimeVerify)=>{f(setTimeout(async()=>{var x;const $=k.current;try{const A=R?await((x=I.current)==null?void 0:x.call(I,_))??_:_;k.current=A,await(a==null?void 0:a(A)),D(w)}catch(A){if(k.current=$,A instanceof ye)w&&(k.current=_,D(!0));else throw A}w&&Z(A=>!A)},e.verifyDebounceTime))},[f,e.verifyDebounceTime,e.actualTimeVerify,a]);return u.useImperativeHandle(t,()=>({verify:async()=>C(k.current,!1,!0)}),[C]),S(y,{children:[c(T,{children:S("div",{className:U(`${B} ${l.type}`,{error:!!h,wrap:p,[l._mode]:!!l._mode},!!m&&m),children:[c("div",{className:`${B}__more`,children:c(Zt,{menu:[{icon:"Clear",label:"重置",title:"将数据设置为默认值，若无默认值则与清空行为一致",value:"reset"},{icon:"Delete",label:"置空",title:"将数据设置为空值，即数据未被设置模式",value:"clear"}],onAction:async _=>{switch(_){case"reset":C(i,!0);break;case"clear":C(void 0,!0,!1);break}},children:c(E,{shape:"square",variant:"text",icon:"More",disabled:!!h})})}),S("div",{className:U(`${B}__label`,{"is-optional":l._def.typeName===d.ZodOptional}),children:[r,o&&c("pre",{className:`${B}__label-description inline-md`,dangerouslySetInnerHTML:{__html:Ce(o)}})]}),c(P,{uKey:n.uKey,model:l,disabled:n.disabled,value:k.current,defaultValue:i,onChange:C})]})}),c(b,{}),c(Lt,{value:k.current,schema:l,onValueChange:g}),h&&c("div",{className:`${B}__error`,children:h.message})]})}const te=u.forwardRef(Ut);te.displayName="Item";function Lt({value:n,schema:t,onValueChange:e}){const{actualTimeVerify:r}=Oe(),[o,s]=u.useState(),i=u.useCallback(async function(a){try{const l=t.parse(a);return s(void 0),l}catch(l){throw console.warn(l),l instanceof ye&&s(l),l}},[t]);return u.useEffect(()=>(r&&i(n).catch(()=>null),e(i)),[r,n,t,i,e]),c("div",{className:U(`${B}__error`,{none:!o}),children:o&&o.errors.map((a,l)=>S("div",{children:[a.path.map(m=>typeof m=="number"?`${m}nd`:m).join(".")," ",a.message]},l))})}const X="zodui-composer-list";function Ft(n,t){const{model:e,value:r,defaultValue:o,onChange:s,disabled:i}=n,a=e._def,l=u.useRef((()=>{const y=e._type===d.ZodObject?{}:e._type===d.ZodArray?[]:void 0;return r??o??y})()),m=u.useCallback(y=>{l.current=y,s==null||s(y)},[s]),p=u.useRef({});if(u.useImperativeHandle(t,()=>({async verify(){const y=Object.entries(p.current).map(([h,T])=>T?T.verify():Promise.resolve());return await Promise.all(y),l.current},reset(){m(o??{})},watch(){throw new Error("Not implemented")},get values(){return l.current}}),[m,o]),v(a,d.ZodIntersection))return S(O,{children:[c(Q,{prefix:"intersect::left",className:n.className,style:n.style,disabled:i,model:a.left,value:l.current,onChange:async y=>m(ie(l.current??{},y))}),c(Q,{prefix:"intersect::right",className:n.className,style:n.style,disabled:i,model:a.right,value:l.current,onChange:async y=>m(ie(l.current??{},y))})]});const b=ee(e,pe);return S("div",{className:U(X,n.className),style:n.style,children:[b&&S("div",{className:`${X}__header`,children:[a.label&&c("h2",{className:U(`${X}__label`,{"is-optional":a.typeName===d.ZodOptional}),children:a.label}),a.description&&c("pre",{className:`${X}__desc inline-md`,dangerouslySetInnerHTML:{__html:Ce(a.description)}})]}),v(a,d.ZodObject)?Object.entries(a.shape()).map(([y,h])=>{var T;return c(te,{ref:N=>p.current[y]=N,uKey:`${n.prefix||""}.${y}`,meta:{label:h._def.label||y,description:h._def.description},model:h,disabled:i,value:(T=l.current)==null?void 0:T[y],onChange:N=>m({...l.current,[y]:N})},y)}):c(te,{ref:y=>p.current.single=y,uKey:"single",meta:{label:e._label||(a==null?void 0:a.description)||e.type,description:a.description},model:e,disabled:i,value:l.current,onChange:m})]})}const Q=u.forwardRef(Ft);Q.displayName="List-Composer";Q.Item=te;function Kt(n,t){return t.includes(n)}function z(n){return n?`${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}`:void 0}const zt=ne("TDesign.React.Components",n=>{n.framework("react").defineComp("Button",({theme:e,...r})=>c(Me,{theme:{info:"default",error:"danger",warning:"warning",success:"success"}[e],...r})).defineComp("Input",({type:e,mode:r,value:o,defaultValue:s,onChange:i,...a})=>{if(Kt(e,["email","tel","url","search"]))return S(O,{children:["Not support type ",e]});if(e==="number"&&r==="split"){const l=m=>m!==void 0?+m:void 0;return c(xe,{value:l(o),defaultValue:l(s),onChange:i})}return c(Ae,{type:e,value:o,defaultValue:s,onChange:l=>i==null?void 0:i(e==="number"?+l:l),...a})}).defineComp("InputAdornment",({prev:e,next:r,...o})=>c(Pe,{prepend:e,append:r,...o})).defineComp("Select",e=>c(Ve,{...e,value:e.value,onChange:r=>{var o;return(o=e.onChange)==null?void 0:o.call(e,r)}})).defineComp("Switch",e=>c(Ue,{...e})).defineComp("RadioGroup",e=>c(fe.Group,{allowUncheck:!0,className:U(e.className,{[`zodui-tdesign-radio-group--direction-${e.direction??"row"}`]:!!e.direction}),variant:{outline:"outline",card:"default-filled",undefined:void 0}[e.variant],options:e.variant!=="outline"?e.options:[],value:e.value,defaultValue:e.defaultValue,onChange:r=>{var o;return(o=e.onChange)==null?void 0:o.call(e,r)},children:e.variant==="outline"?e.options.map(r=>c(fe.Button,{value:r.value,title:r.title,disabled:r.disabled,children:r.label},r.value)):null})).defineComp("Dropdown",e=>c(Le,{popupProps:{showArrow:!0,overlayClassName:"zodui-tdesign-popup",popperOptions:{modifiers:[{name:"offset",options:{offset:[4,0]}}]}},options:e.menu.map(r=>({prefixIcon:typeof r.icon=="string"?c(Ne,{name:r.icon}):r.icon,content:typeof r.label=="string"?c("span",{title:r.title,children:r.label}):u.cloneElement(r.label,{title:r.title}),value:r.value,disabled:r.disabled})),trigger:e.trigger??"click",minColumnWidth:120,onClick:r=>{e.onAction(r.value,r)},children:e.children}))}),Bt=Object.freeze(Object.defineProperty({__proto__:null,ComponentsOfTDesignComponentsLibForReact:zt},Symbol.toStringTag,{value:"Module"})),Ht=ne("TDesign.React.Renders",n=>{n.framework("react").defineIcon("Add",Qe).defineIcon("More",Xe).defineIcon("Link",Ye).defineIcon("Clear",et).defineIcon("Delete",tt).defineIcon("Prepend",e=>c(me,{style:{transform:"rotate(90deg)"},...e})).defineIcon("Append",e=>c(me,{style:{transform:"rotate(-90deg)"},...e})).defineIcon("ArrowUp",nt).defineIcon("ArrowDown",rt)}),qt=Object.freeze(Object.defineProperty({__proto__:null,IconsOfTDesignComponentsLibForReact:Ht},Symbol.toStringTag,{value:"Module"})),Gt=ne("TDesign.React.Renders",n=>{n.framework("react").defineRndr("Number:Slider",e=>{const[r,o]=le(e.value,e.defaultValue,e.onChange);return c(Fe,{...e,value:r,onChange:o,...e.range?{defaultValue:e.defaultValue??[0,0],onChange:([s,i])=>o==null?void 0:o([s??0,i??0])}:{}})}).defineRndr("String:TextArea",e=>c(Ke,{autosize:{minRows:1},...e})).defineRndr("Date:Picker",({isPanel:e,datetime:[r,o]=[!0,!0],...s})=>{const i=s.onChange,a=u.useCallback(m=>m===void 0?i==null?void 0:i(void 0):i==null?void 0:i(new Date(m)),[i]);if(!r){const m=z(s.value),p=z(s.defaultValue);return e?c(ze,{...s,value:p||m,onChange:b=>a(`1970-01-01 ${b}`)}):c(Be,{...s,value:m,defaultValue:p,onChange:b=>a(`1970-01-01 ${b}`)})}const l={...s,enableTimePicker:r&&o};return e?c(He,{...l,onChange:m=>a(m)}):c(qe,{...l,valueType:"Date",onChange:m=>a(m)})}).defineRndr("Range:Date:Picker",({isPanel:e,datetime:[r,o]=[!0,!0],...s})=>{if(s.value===void 0&&(s.value=[]),!r&&o)return e?S(O,{children:["TDesign unable support ",c("code",{children:"TimePickerRangePanel"}),"."]}):c(Ge,{...s,value:[z(s.value[0]),z(s.value[1])],defaultValue:[z(s.defaultValue[0]),z(s.defaultValue[1])],onChange:a=>{var l;return(l=s.onChange)==null?void 0:l.call(s,[new Date(`1970-01-01 ${a[0]}`),new Date(`1970-01-01 ${a[1]}`)])}});const i={...s,enableTimePicker:r&&o};return e?c(We,{...i,onChange:a=>{var l;return(l=s.onChange)==null?void 0:l.call(s,[new Date(a[0]),new Date(a[1])])}}):c(Je,{...i,valueType:"Date",onChange:a=>{var l;return(l=s.onChange)==null?void 0:l.call(s,[new Date(a[0]),new Date(a[1])])}})})}),Wt=Object.freeze(Object.defineProperty({__proto__:null,RendersOfTDesignComponentsLibForReact:Gt},Symbol.toStringTag,{value:"Module"})),cn=ne("TDesign.React",n=>{n.use(()=>re(()=>Promise.resolve().then(()=>Bt),void 0).then(({ComponentsOfTDesignComponentsLibForReact:t})=>t)),n.use(()=>re(()=>Promise.resolve().then(()=>qt),void 0).then(({IconsOfTDesignComponentsLibForReact:t})=>t)),n.use(()=>re(()=>Promise.resolve().then(()=>Wt),void 0).then(({RendersOfTDesignComponentsLibForReact:t})=>t))});export{d as A,se as C,O as F,Y as I,Q as L,sn as R,kt as S,cn as T,re as _,on as a,Ne as b,oe as c,ne as d,rn as e,_e as f,S as g,c as j,Te as n,nn as u};
